<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>预备知识：Django 第一步 &mdash; Practical Django 1.3 文档</title>
    
    <link rel="stylesheet" href="../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Practical Django 1.3 文档" href="../index.html" /> 
  </head>
  <body role="document">
  
  


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="django">
<span id="id1"></span><h1>预备知识：Django 第一步<a class="headerlink" href="#django" title="永久链接至标题">¶</a></h1>
<p>对于一个 Web 框架，掌握了三部分的内容，就可以说是迈出了第一步。</p>
<ol class="arabic simple">
<li>准备开发环境</li>
<li>创建一个工程，并运行</li>
<li>开发hello world应用</li>
</ol>
<div class="section" id="id2">
<h2>准备环境<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>首先应该是安装 Python 2.7 和 Django 1.3。这点官方网站有很详细的说明，网上也有很多教程，这里就不再重复了，只是表达一个对操作系统的观点：</p>
<ul class="simple">
<li>OS X：对程序员和用户都很友好</li>
<li>Linux：对程序员很友好</li>
<li>Windows：对用户貌似友好</li>
</ul>
<p>到底使用哪个操作系统，仁者见仁。</p>
<p>然后是开发工具的选择。建议抛弃 IDE，使用一个好的文本编辑器。强烈推荐 Vim。但如果你选择 Emacs，我无话可说。</p>
</div>
<div class="section" id="id3">
<h2>创建工程<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>Django 作为一个 Web 框架，第一步应该是能够在浏览器中看到页面。如果已经安装好环境的话。</p>
<p>首先创建工程，即开始创建名为 <em>depot</em> 的工程：</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ django-admin.py startproject depot
</pre></div>
</div>
<p>与 Rails 相比，过程很安静，结果很干净。如下：</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>depot/
    __init__.py
    manage.py
    settings.py
    urls.py
</pre></div>
</div>
<p>这几个文件的作用如下：</p>
<ul class="simple">
<li>_init__.py：Python 的模块定义文件。这是一个空文件，一般你不需要修改它。</li>
<li>manage.py：一个命令行工具，生成这个文件仅仅是为了方便。可以通过 <cite>$ python manage.py help</cite> 查看该工具的功能。完全不需要编辑这个文件。</li>
<li>settings.py：该 Django 项目的设置或配置。</li>
<li>urls.py：Django 项目的 URL 设置。</li>
</ul>
<p>与 Rails 不同，Django 初始工程的文件很少，可以很容易地阅读所有的代码。但这些文件已经构成了一个可运行的 Django 应用。</p>
<p>进入工程目录并运行该工程：</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ cd depot/
$ python manage.py runserver
</pre></div>
</div>
<p>可以看到一些提示信息：</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>Validating models...

0 errors found
Django version 1.3, using settings &#39;depot.settings&#39;
Development server is running at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
</pre></div>
</div>
<p>此时 Web Server （开发环境）已经运行了，用浏览器访问http://127.0.0.1:8000/，可以看到如下的界面：</p>
<img alt="../_images/0.2_hello_world.png" src="../_images/0.2_hello_world.png" />
<p>说明Django已经开始工作了。</p>
</div>
<div class="section" id="hello-django">
<h2>hello Django！<a class="headerlink" href="#hello-django" title="永久链接至标题">¶</a></h2>
<p>与 Rails 不同，Django 不需要生成 controller、helper、view 等一大堆文件，要实现一个 hello 程序，只需要几行代码。</p>
<p>Django Web 应用中通常包含 URLconf, view, template, model 四个部分。但这些部分不是完全必需的。比如我们要实现一个最简单的 <strong>hello, Django!</strong> ，只需要定义 URLconf 和 view 即可。</p>
<p>让我们把“需求”明确一下，<strong>hello,Django！</strong> 实现如下功能：在浏览器中输入 <a class="reference external" href="http://127.0.0.1:8000/hello">http://127.0.0.1:8000/hello</a>, 显示 <cite>hello Django!</cite>。</p>
<p>首先要实现一个视图（view) 来响应请求。在 Django 中视图是一个函数，该函数接受一个 HttpRequest 参数，并返回一个 HttpResponse。我们可以在任何地方定义这个函数，但通常会放在 Django app 的 views.py 文件中。在 <strong>hello,Django!</strong> 中我们不需要创建一个 Django app（因为不需要 model），所以可以在项目目录 Depot 中创建一个 view.py 文件，并定义 hello 视图函数：</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># depot/views.py:</span>

<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;hello, Django!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>接下来是将前面定义的 URL 映射到这个视图函数。这是由 URLconf 完成的。URLconf 的本质是 URL 模式以及要为该 URL 模式调用的视图函数之间的映射表。</p>
<p>打开生成的 urls.py 文件，先在文件前面 import 刚才创建的 view，然后在 tuple 类型的变量 urlpatterns 中加入 hello 的映射关系：</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># depot/urls.py</span>

<span class="kn">from</span> <span class="nn">django.conf.urls.defaults</span> <span class="kn">import</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">depot.views</span> <span class="kn">import</span> <span class="n">hello</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
   <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^hello/$&#39;</span><span class="p">,</span> <span class="n">hello</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>此时访问 <a class="reference external" href="http:/127.0.0.1:8000/hello">http:/127.0.0.1:8000/hello</a>, 将会显示 <cite>hello, Django!</cite>。</p>
<p>URLconf 理解起来也很容易，即 urlpatterns 中的每一项是一个二元组 <cite>(正则表达式，视图函数)</cite>。当 Django 接收到 HTTP 请求的时候，从 urlpatterns 中找到匹配的表达式，并将请求发送给对应的视图函数，最后视图函数返回一个 HTTP 响应，交给 Django 处理。如此而已。</p>
<p>至此，Django 的第一步已经迈出，你至少已经可以开始 CGI 风格的 Web 开发了。</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <a href="http://github.com/xuehao/Practical_Django"><img style="position: fixed; top: 0; right: 0; border: 0;"
    src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>
  

  

  </body>
</html>